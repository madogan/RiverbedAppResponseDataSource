define(["react","@grafana/ui","@grafana/data","@grafana/runtime","lodash"],(function(e,t,n,r,o){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=52)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){e.exports=r},function(e,t,n){var r=n(11),o=n(29),a=n(30),i=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?o(e):a(e)}},function(e,t,n){var r=n(12),o="object"==typeof self&&self&&self.Object===Object&&self,a=r||o||Function("return this")();e.exports=a},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t){e.exports=o},function(e,t){e.exports=function(e){return e}},function(e,t,n){var r=n(5),o=n(3);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){var r=n(6).Symbol;e.exports=r},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(28))},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(10),o=n(15);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r=n(19),o=n(13),a=n(36),i=n(37),s=Object.prototype,c=s.hasOwnProperty,u=r((function(e,t){e=Object(e);var n=-1,r=t.length,u=r>2?t[2]:void 0;for(u&&a(t[0],t[1],u)&&(r=1);++n<r;)for(var p=t[n],l=i(p),h=-1,d=l.length;++h<d;){var f=l[h],v=e[f];(void 0===v||o(v,s[f])&&!c.call(e,f))&&(e[f]=p[f])}return e}));e.exports=u},function(e,t,n){var r=n(9),o=n(20),a=n(22);e.exports=function(e,t){return a(o(e,t,r),e+"")}},function(e,t,n){var r=n(21),o=Math.max;e.exports=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var a=arguments,i=-1,s=o(a.length-t,0),c=Array(s);++i<s;)c[i]=a[t+i];i=-1;for(var u=Array(t+1);++i<t;)u[i]=a[i];return u[t]=n(c),r(e,this,u)}}},function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},function(e,t,n){var r=n(23),o=n(35)(r);e.exports=o},function(e,t,n){var r=n(24),o=n(25),a=n(9),i=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:a;e.exports=i},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t,n){var r=n(26),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,n){var r=n(27),o=n(34);e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},function(e,t,n){var r=n(10),o=n(31),a=n(3),i=n(33),s=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,p=c.toString,l=u.hasOwnProperty,h=RegExp("^"+p.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!a(e)||o(e))&&(r(e)?h:s).test(i(e))}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(11),o=Object.prototype,a=o.hasOwnProperty,i=o.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=a.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var o=i.call(e);return r&&(t?e[s]=n:delete e[s]),o}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r,o=n(32),a=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!a&&a in e}},function(e,t,n){var r=n(6)["__core-js_shared__"];e.exports=r},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t){var n=Date.now;e.exports=function(e){var t=0,r=0;return function(){var o=n(),a=16-(o-r);if(r=o,a>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,n){var r=n(13),o=n(14),a=n(16),i=n(3);e.exports=function(e,t,n){if(!i(n))return!1;var s=typeof t;return!!("number"==s?o(n)&&a(t,n.length):"string"==s&&t in n)&&r(n[t],e)}},function(e,t,n){var r=n(38),o=n(49),a=n(14);e.exports=function(e){return a(e)?r(e,!0):o(e)}},function(e,t,n){var r=n(39),o=n(40),a=n(42),i=n(43),s=n(16),c=n(45),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=a(e),p=!n&&o(e),l=!n&&!p&&i(e),h=!n&&!p&&!l&&c(e),d=n||p||l||h,f=d?r(e.length,String):[],v=f.length;for(var g in e)!t&&!u.call(e,g)||d&&("length"==g||l&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,v))||f.push(g);return f}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(41),o=n(7),a=Object.prototype,i=a.hasOwnProperty,s=a.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(e){return o(e)&&i.call(e,"callee")&&!s.call(e,"callee")};e.exports=c},function(e,t,n){var r=n(5),o=n(7);e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){(function(e){var r=n(6),o=n(44),a=t&&!t.nodeType&&t,i=a&&"object"==typeof e&&e&&!e.nodeType&&e,s=i&&i.exports===a?r.Buffer:void 0,c=(s?s.isBuffer:void 0)||o;e.exports=c}).call(this,n(17)(e))},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(46),o=n(47),a=n(48),i=a&&a.isTypedArray,s=i?o(i):r;e.exports=s},function(e,t,n){var r=n(5),o=n(15),a=n(7),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return a(e)&&o(e.length)&&!!i[r(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){(function(e){var r=n(12),o=t&&!t.nodeType&&t,a=o&&"object"==typeof e&&e&&!e.nodeType&&e,i=a&&a.exports===o&&r.process,s=function(){try{var e=a&&a.require&&a.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=s}).call(this,n(17)(e))},function(e,t,n){var r=n(3),o=n(50),a=n(51),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return a(e);var t=o(e),n=[];for(var s in e)("constructor"!=s||!t&&i.call(e,s))&&n.push(s);return n}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t,n){"use strict";n.r(t);var r=n(2);function o(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))}Object.create;Object.create;var a,i=n(18),s=n.n(i),c=n(4);!function(e){e.ip="IP",e.webApp="Web App",e.hostGroup="Host Group",e.application="Application"}(a||(a={}));var u=[{label:"Application",value:a.application},{label:"Host Group",value:a.hostGroup},{label:"Web App",value:a.webApp},{label:"IP",value:a.ip}],p=[{value:0,label:"Auto"},{value:60,label:"60 seconds"},{value:300,label:"5 minutes"},{value:3600,label:"1 hour"},{value:21600,label:"6 hours"},{value:86400,label:"1 day"}],l={timeshift:0,granularity:p[0],sourceGroup:a.application,top:!1,topN:10,topGraph:!1,webApps:[],webAppMetrics:[],hostGroups:[],hostGroupMetrics:[],applications:[],applicationMetrics:[]};function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var o=b(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return g(this,n)}}function g(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(h,e);var t,n,i,u=v(h);function h(e){var t,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(t=u.call(this,e)).data=[],t.ipMetrics=[],t.topMetrics=[],t.webApps=[],t.webAppMetrics=[],t.hostGroups=[],t.hostGroupMetrics=[],t.applications=[],t.applicationMetrics=[],t.queryTimeout=60,t.optionsTimeout=15,t.settings=e,t.url=t.settings.url||"",t.token=null!==(n=e.jsonData.token)&&void 0!==n?n:"",t.urls={base:t.url+"/base",auth:t.url+"/auth",webApp:t.url+"/webapps",metric:t.url+"/aggregates",hostGroup:t.url+"/hostgroups",application:t.url+"/applications",instanceCreationSync:t.url+"/instancecreationsync"},t.headers={"Content-Type":"application/json"},t.lastFetchQuery=new Date,t.lastFetchMetrics=new Date,t.lastFetchWebApps=new Date,t.lastFetchWebAppMetrics=new Date,t.lastFetchHostGroups=new Date,t.lastFetchHostGroupMetrics=new Date,t.lastFetchApplications=new Date,t.lastFetchApplicationMetrics=new Date,t.lastFetchIPMetrics=new Date,t}return t=h,(n=[{key:"topngraphquery",value:function(e,t,n,r){return o(this,void 0,void 0,regeneratorRuntime.mark((function o(){var i,s,c,u,p,l;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(s=[],c=[],s=[{direction:"desc",id:e.currentTopMetric.value}],e.sourceGroup!==a.application){o.next=8;break}c=["app.id","app.name"],i=["start_time","app.id"],o.next=24;break;case 8:if(e.sourceGroup!==a.hostGroup){o.next=13;break}c=["host_group.id","host_group.name"],i=["start_time","host_group.id"],o.next=24;break;case 13:if(e.sourceGroup!==a.webApp){o.next=18;break}c=["app.id","app.name"],i=["start_time","app.id"],o.next=24;break;case 18:if(e.sourceGroup!==a.ip){o.next=23;break}c=["tcp.ip","tcp.dns"],i=["start_time","tcp.ip"],o.next=24;break;case 23:throw new Error("Unknown source group");case 24:return c.push(e.currentTopMetric.value),u=[],p="",o.next=29,this.doRequest({method:"POST",url:this.urls.instanceCreationSync,data:{data_defs:[{source:{name:"aggregates"},time:{start:t.toString(),end:n.toString(),granularity:r.toString()},top_by:s,columns:c,limit:e.topN||10}]}}).then((function(e){var t;t=e.data.data_defs[0].hasOwnProperty("data")?e.data.data_defs[0].data:[];for(var n=0;n<t.length;n++)u.push(t[n][1]),n===t.length-1?p+="'".concat(t[n][0],"'"):p+="'".concat(t[n][0],"', ");return p}));case 29:return c.unshift("start_time"),o.next=32,this.doRequest({method:"POST",url:this.urls.instanceCreationSync,data:{data_defs:[{source:{name:"aggregates"},time:{start:t.toString(),end:n.toString(),granularity:r.toString()},group_by:i,columns:c,filters:[{type:"STEELFILTER",value:"".concat(c[1]," IN (").concat(p,")")}]}]}}).then((function(e){return e.data.data_defs[0].hasOwnProperty("data")?e.data:[]}));case 32:return l=o.sent,o.abrupt("return",{tops:u,result:l});case 34:case"end":return o.stop()}}),o,this)})))}},{key:"query",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,o,i,c,u,h,d,f,v,g,b,m,y=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.range,o=n.to.valueOf(),i=n.from.valueOf(),d={},f={},v=[],b=[],m=e.targets.map((function(e){var t,n,m,w,j,O,x,M=s()(e,l);if(c=new Date(o).getTime()/1e3,u=new Date(i).getTime()/1e3,0===(null==(h=M.granularity)?void 0:h.value)){var k=(c-u)/60;h=k<60?p[1]:k<360?p[2]:k<7200?p[3]:k<86400?p[4]:p[5]}if(d={name:"aggregates"},M.sourceGroup==a.hostGroup)f=["start_time","host_group.id"],v=["start_time","host_group.id","host_group.name"],b.push({type:"STEELFILTER",value:"host_group.id == "+(null===(t=M.currentHostGroup)||void 0===t?void 0:t.value)}),v.push(null===(n=M.currentHostGroupMetric)||void 0===n?void 0:n.value),g=M.currentHostGroupMetric;else if(M.sourceGroup===a.application)f=["start_time","app.id"],v=["start_time","app.id","app.name"],b.push({type:"STEELFILTER",value:"app.id == "+(null===(m=M.currentApplication)||void 0===m?void 0:m.value)}),v.push(null===(w=M.currentApplicationMetric)||void 0===w?void 0:w.value),g=M.currentApplicationMetric;else if(M.sourceGroup===a.ip)d={name:"aggregates"},f=["start_time"],v=["start_time","tcp.ip","tcp.dns"],b.push({type:"STEELFILTER",value:"tcp.ip == "+M.currentIP}),v.push(null===(j=M.currentIPMetric)||void 0===j?void 0:j.value),g=M.currentIPMetric;else{if(M.sourceGroup!==a.webApp)throw new Error("Unknown source group");f=["start_time","app.id"],v=["start_time","app.id","app.name"],b.push({type:"STEELFILTER",value:"app.id == "+(null===(O=M.currentWebApp)||void 0===O?void 0:O.value)}),v.push(null===(x=M.currentWebAppMetric)||void 0===x?void 0:x.value),g=M.currentWebAppMetric}var A={source:d,time:{end:c.toString(),start:u.toString(),granularity:null==h?void 0:h.value.toString()},group_by:f,columns:v};if(M.top){if(A.limit=M.topN||10,A.top_by=[{id:null==g?void 0:g.value,direction:"desc"}],A.group_by={},A.columns=A.columns.slice(1),M.topGraph)return y.topngraphquery(M,u,c,0).then((function(e){var t,n,o=e.tops,a=e.result.data_defs[0];a.hasOwnProperty("data")||(a.data=[]),n=void 0!==M.alias&&""!==M.alias.trim()?M.alias:null===(t=M.currentTopMetric)||void 0===t?void 0:t.label;for(var i=[{name:"Time",type:r.FieldType.time,values:[]}],s=0;s<o.length;s++)i.push({name:o[s],type:r.FieldType.number,values:[]});for(var c=new r.MutableDataFrame({name:n,fields:i,refId:M.refId}),u=0;u<a.data.length;u++){var p=[],l=a.data[u];p.push(new Date(1e3*l[0]));for(var h=0;h<o.length;h++)o[h]===l[2]?p.push(l[l.length-1]):p.push(null);c.appendRow(p)}return c}))}else A.filters=b;return y.doRequest({url:y.urls.instanceCreationSync,data:{data_defs:[A]},method:"POST"}).then((function(e){var t,n=e.data.data_defs[0];void 0===n.data&&(n.data=[]),t=void 0!==M.alias&&""!==M.alias.trim()?M.alias:null==g?void 0:g.value;var o,a=[];if(M.top){for(var i=[],s=0;s<n.columns.length;s++){var c=n.columns[s];-1===c.search("id")?a.push({name:c,type:r.FieldType.other}):i.push(s)}o=new r.MutableDataFrame({refId:M.refId,name:t,fields:a});for(var u=function(e){i.forEach((function(t){n.data[e].splice(t,1)})),o.appendRow(n.data[e])},p=0;p<n.data.length;p++)u(p)}else{a=[{name:"Time",type:r.FieldType.time},{name:"Value",type:r.FieldType.number}],o=new r.MutableDataFrame({refId:M.refId,name:t,fields:a});for(var l=0;l<n.data.length;l++){var h=n.data[l];o.appendRow([new Date(1e3*h[0]),h[h.length-1]])}}return y.data.push(o),o}))})),t.abrupt("return",Promise.all(m).then((function(e){return{data:e}})));case 9:case"end":return t.stop()}}),t)})))}},{key:"testDatasource",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(c.getBackendSrv)().datasourceRequest({method:"POST",url:this.urls.auth,headers:this.headers}).then((function(e){return!0===e.ok?(t.settings.jsonData.token=e.data.access_token,{status:"success",message:"Data source is working"}):{status:"error",message:"Data source is not working"}})).catch((function(e){return{status:"error",message:e.statusText}})));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"doRequest",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==this.settings.jsonData.token&&void 0!==this.settings.jsonData.token&&null!==this.settings.jsonData.token){t.next=5;break}return t.next=5,Object(c.getBackendSrv)().datasourceRequest({method:"POST",url:this.urls.auth}).then((function(e){n.settings.jsonData.token=e.data.access_token}));case 5:return t.abrupt("return",Object(c.getBackendSrv)().datasourceRequest(Object.assign(Object.assign({},e),{headers:Object.assign(Object.assign({},this.headers),{Authorization:"Bearer "+this.settings.jsonData.token})})));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"getHostGroups",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],e.prev=2,!((Date.now()-this.lastFetchHostGroups.getTime())/1e3/60<this.optionsTimeout&&this.hostGroups.length>0)){e.next=6;break}return e.abrupt("return",this.hostGroups);case 6:return e.next=8,this.doRequest({method:"GET",url:this.urls.hostGroup}).then((function(e){if(n.hostGroups=[],void 0!==e)for(var r in e.data.items)if(e.data.items[r].enabled){var o={label:e.data.items[r].name,value:e.data.items[r].id};t.push(o),n.hostGroups.push(o)}n.lastFetchHostGroups=new Date(Date.now())}));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2);case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[2,10]])})))}},{key:"getApplications",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],e.prev=1,!((Date.now()-this.lastFetchApplications.getTime())/1e3/60<this.optionsTimeout&&this.applications.length>0)){e.next=5;break}return e.abrupt("return",this.applications);case 5:return e.next=7,this.doRequest({method:"GET",url:this.urls.application}).then((function(e){if(void 0!==e)for(var r in n.applications=[],e.data.items)if(e.data.items[r].enabled){var o={label:e.data.items[r].name,value:e.data.items[r].id};t.push(o),n.applications.push(o)}n.lastFetchApplications=new Date(Date.now())}));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1);case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this,[[1,9]])})))}},{key:"getWebApps",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],e.prev=1,!((Date.now()-this.lastFetchWebApps.getTime())/1e3/60<this.optionsTimeout&&this.webApps.length>0)){e.next=5;break}return e.abrupt("return",this.webApps);case 5:return e.next=7,this.doRequest({method:"GET",url:this.urls.webApp}).then((function(e){if(void 0!==e)for(var r in n.webApps=[],e.data.items)if(e.data.items[r].enabled){var o={label:e.data.items[r].name,value:e.data.items[r].id};t.push(o),n.webApps.push(o)}n.lastFetchWebApps=new Date(Date.now())}));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1);case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this,[[1,9]])})))}},{key:"getTopMetrics",value:function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e!==a.application){t.next=6;break}return t.next=3,this.getApplicationMetrics();case 3:this.topMetrics=t.sent,t.next=25;break;case 6:if(e!==a.hostGroup){t.next=12;break}return t.next=9,this.getHostGroupMetrics();case 9:this.topMetrics=t.sent,t.next=25;break;case 12:if(e!==a.webApp){t.next=18;break}return t.next=15,this.getWebAppMetrics();case 15:this.topMetrics=t.sent,t.next=25;break;case 18:if(e!==a.ip){t.next=24;break}return t.next=21,this.getIPMetrics();case 21:this.topMetrics=t.sent,t.next=25;break;case 24:throw new Error("Unknown source group");case 25:return t.abrupt("return",this.topMetrics);case 26:case"end":return t.stop()}}),t,this)})))}},{key:"getApplicationMetrics",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],e.prev=1,!((Date.now()-this.lastFetchApplicationMetrics.getTime())/1e3/60<this.optionsTimeout&&this.applicationMetrics.length>0)){e.next=5;break}return e.abrupt("return",this.applicationMetrics);case 5:return e.next=7,this.doRequest({method:"GET",url:this.urls.metric}).then((function(e){if(void 0!==e)for(var r in n.applicationMetrics=[],e.data.columns){var o=e.data.columns[r].id,a=e.data.columns[r].unit,i=e.data.columns[r].rate,s=e.data.columns[r].label;if(!(o.endsWith(".id")||o.endsWith("_id")||o.endsWith(".id")||o.endsWith(".name")||o.endsWith("_name")||o.endsWith(".ip")||o.endsWith("_ip")||o.endsWith(".url")||o.endsWith("_url")||o.endsWith(".type")||o.endsWith("_type")||o.endsWith(".dns")||o.endsWith("_dns")||o.endsWith("start_time")||o.endsWith("end_time")||o.includes("rtp"))){void 0!==i&&"none"!==a?s="".concat(s," (").concat(a,"/").concat(i,")"):void 0!==i&&(s="".concat(s," (").concat(i,")"));var c={value:o,label:s};o.includes("p2m")||o.includes("m2p")||o.includes("web")||o.includes("_db.")||o.includes("cxa")||(t.push(c),n.applicationMetrics.push(c))}}n.lastFetchApplicationMetrics=new Date(Date.now())}));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1);case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this,[[1,9]])})))}},{key:"getIPMetrics",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],e.prev=1,!((Date.now()-this.lastFetchIPMetrics.getTime())/1e3/60<this.optionsTimeout&&this.ipMetrics.length>0)){e.next=5;break}return e.abrupt("return",this.ipMetrics);case 5:return e.next=7,this.doRequest({method:"GET",url:this.urls.metric}).then((function(e){if(void 0!==e)for(var r in n.ipMetrics=[],e.data.columns){var o=e.data.columns[r].id,a=e.data.columns[r].unit,i=e.data.columns[r].rate,s=e.data.columns[r].label;if(!(o.endsWith(".id")||o.endsWith("_id")||o.endsWith(".id")||o.endsWith(".name")||o.endsWith("_name")||o.endsWith(".ip")||o.endsWith("_ip")||o.endsWith(".url")||o.endsWith("_url")||o.endsWith(".type")||o.endsWith("_type")||o.endsWith(".dns")||o.endsWith("_dns")||o.endsWith("start_time")||o.endsWith("end_time")||o.includes("rtp"))){void 0!==i&&"none"!==a?s="".concat(s," (").concat(a,"/").concat(i,")"):void 0!==i&&(s="".concat(s," (").concat(i,")"));var c={value:o,label:s};o.includes("p2m")||o.includes("m2p")||o.includes("web")||o.includes("_db.")||o.includes("cxa")||(t.push(c),n.ipMetrics.push(c))}}n.lastFetchIPMetrics=new Date(Date.now())}));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1);case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this,[[1,9]])})))}},{key:"getHostGroupMetrics",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],e.prev=1,!((Date.now()-this.lastFetchHostGroupMetrics.getTime())/1e3/60<this.optionsTimeout&&this.hostGroupMetrics.length>0)){e.next=5;break}return e.abrupt("return",this.hostGroupMetrics);case 5:return e.next=7,this.doRequest({method:"GET",url:this.urls.metric}).then((function(e){if(void 0!==e)for(var r in n.hostGroupMetrics=[],e.data.columns){var o=e.data.columns[r].id,a=e.data.columns[r].unit,i=e.data.columns[r].rate,s=e.data.columns[r].label;if(!(o.endsWith(".id")||o.endsWith("_id")||o.endsWith(".id")||o.endsWith(".name")||o.endsWith("_name")||o.endsWith(".ip")||o.endsWith("_ip")||o.endsWith(".url")||o.endsWith("_url")||o.endsWith(".type")||o.endsWith("_type")||o.endsWith(".dns")||o.endsWith("_dns")||o.endsWith("start_time")||o.endsWith("end_time")||o.includes("rtp"))){void 0!==i&&"none"!==a?s="".concat(s," (").concat(a,"/").concat(i,")"):void 0!==i&&(s="".concat(s," (").concat(i,")"));var c={value:o,label:s};t.push(c),n.hostGroupMetrics.push(c)}}n.lastFetchHostGroupMetrics=new Date(Date.now())}));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1);case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this,[[1,9]])})))}},{key:"getWebAppMetrics",value:function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],e.prev=1,!((Date.now()-this.lastFetchWebAppMetrics.getTime())/1e3/60<this.optionsTimeout&&this.webAppMetrics.length>0)){e.next=5;break}return e.abrupt("return",this.webAppMetrics);case 5:return e.next=7,this.doRequest({method:"GET",url:this.urls.metric}).then((function(e){if(void 0!==e)for(var r in n.webAppMetrics=[],e.data.columns){var o=e.data.columns[r].id,a=e.data.columns[r].unit,i=e.data.columns[r].rate,s=e.data.columns[r].label;if(!(o.endsWith(".id")||o.endsWith("_id")||o.endsWith(".id")||o.endsWith(".name")||o.endsWith("_name")||o.endsWith(".ip")||o.endsWith("_ip")||o.endsWith(".url")||o.endsWith("_url")||o.endsWith(".type")||o.endsWith("_type")||o.endsWith(".dns")||o.endsWith("_dns")||o.endsWith("start_time")||o.endsWith("end_time")||o.includes("rtp"))){void 0!==i&&"none"!==a?s="".concat(s," (").concat(a,"/").concat(i,")"):void 0!==i&&(s="".concat(s," (").concat(i,")"));var c={value:o,label:s};o.includes("_web.")&&(t.push(c),n.webAppMetrics.push(c))}}n.lastFetchWebAppMetrics=new Date(Date.now())}));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1);case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this,[[1,9]])})))}}])&&d(t.prototype,n),i&&d(t,i),Object.defineProperty(t,"prototype",{writable:!1}),h}(r.DataSourceApi),y=n(0),w=n.n(y),j=n(1);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=G(e);if(t){var o=G(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return E(this,n)}}function E(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(a,e);var t,n,r,o=A(a);function a(){var e;return x(this,a),(e=o.apply(this,arguments))._onOptionsChange=function(t){var n=e.props,r=n.onOptionsChange,o=n.options;return r(Object.assign(Object.assign({},o),t))},e.onPathChange=function(t){var n=e.props,r=n.onOptionsChange,o=n.options,a=Object.assign(Object.assign({},o.jsonData),{path:t.target.value});r(Object.assign(Object.assign({},o),{jsonData:a}))},e.onTlsSkipVerifyChange=function(t){var n=e.props,r=n.onOptionsChange,o=n.options,a=Object.assign(Object.assign({},o.jsonData),{tlsSkipVerify:t.target.checked,skipTlsVerify:t.target.checked});r(Object.assign(Object.assign({},o),{jsonData:a}))},e.onUsernameChange=function(t){var n=e.props,r=n.onOptionsChange,o=n.options,a=Object.assign(Object.assign({},o.jsonData),{username:t.target.value});r(Object.assign(Object.assign({},o),{jsonData:a}))},e.onPasswordChange=function(t){var n=e.props,r=n.onOptionsChange,o=n.options;r(Object.assign(Object.assign({},o),{secureJsonData:{password:t.target.value}}))},e.onResetPassword=function(){var t=e.props,n=t.onOptionsChange,r=t.options;n(Object.assign(Object.assign({},r),{secureJsonFields:Object.assign(Object.assign({},r.secureJsonFields),{password:!1}),secureJsonData:Object.assign(Object.assign({},r.secureJsonData),{password:""})}))},e}return t=a,(n=[{key:"render",value:function(){var e=this.props.options,t=e.secureJsonFields,n=j.LegacyForms.Input,r=j.LegacyForms.SecretFormField,o=e.secureJsonData||{};return w.a.createElement("div",null,w.a.createElement("div",{className:"gf-form-inline"},w.a.createElement("div",{className:"gf-form"},w.a.createElement(j.InlineFormLabel,{className:"width-10"},"Path"),w.a.createElement("div",{className:"width-10"},w.a.createElement(n,{className:"width-20",value:e.jsonData.path||"",onChange:this.onPathChange})))),w.a.createElement("div",{className:"gf-form-inline"},w.a.createElement("div",{className:"gf-form"},w.a.createElement(j.InlineFormLabel,{className:"width-10"},"User"),w.a.createElement("div",{className:"width-10"},w.a.createElement(n,{className:"width-20",value:e.jsonData.username||"",onChange:this.onUsernameChange})))),w.a.createElement("div",{className:"gf-form-inline"},w.a.createElement("div",{className:"gf-form"},w.a.createElement(r,{isConfigured:t&&t.password,value:o.password||"",label:"Password","aria-label":"Password",labelWidth:10,inputWidth:20,onReset:this.onResetPassword,onChange:this.onPasswordChange}))),w.a.createElement("div",{className:"gf-form-inline"},w.a.createElement("div",{className:"gf-form"},w.a.createElement(j.InlineFieldRow,null,w.a.createElement(j.InlineField,{label:"Skip TLS Verify"},w.a.createElement(j.InlineSwitch,{value:e.jsonData.tlsSkipVerify||e.jsonData.skipTlsVerify,checked:e.jsonData.tlsSkipVerify||e.jsonData.skipTlsVerify,onChange:this.onTlsSkipVerifyChange}))))))}}])&&M(t.prototype,n),r&&M(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(y.PureComponent),_=n(8);function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=I(e);if(t){var o=I(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return F(this,n)}}function F(e,t){if(t&&("object"===S(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return D(e)}function D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(s,e);var t,n,r,i=W(s);function s(){var e;return C(this,s),(e=i.apply(this,arguments)).getHostGroups=function(){return o(D(e),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.query,r=t.datasource,o=t.onChange,e.next=4,r.getHostGroups();case 4:(a=e.sent).length!==(n.hostGroups.length||0)&&o(Object.assign(Object.assign({},n),{hostGroups:a}));case 6:case"end":return e.stop()}}),e,this)})))},e.getApplications=function(){return o(D(e),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.query,r=t.datasource,o=t.onChange,e.next=4,r.getApplications();case 4:(a=e.sent).length!==(n.applications.length||0)&&o(Object.assign(Object.assign({},n),{applications:a}));case 6:case"end":return e.stop()}}),e,this)})))},e.getWebApps=function(){return o(D(e),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.query,r=t.datasource,o=t.onChange,e.next=4,r.getWebApps();case 4:(a=e.sent).length!==(n.webApps.length||0)&&o(Object.assign(Object.assign({},n),{webApps:a}));case 6:case"end":return e.stop()}}),e,this)})))},e.getApplicationMetrics=function(){return o(D(e),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props,r=n.query,o=n.datasource,a=n.onChange,e.next=4,o.getApplicationMetrics();case 4:(i=e.sent).length!==((null===(t=r.applicationMetrics)||void 0===t?void 0:t.length)||0)&&a(Object.assign(Object.assign({},r),{applicationMetrics:i}));case 6:case"end":return e.stop()}}),e,this)})))},e.getIPMetrics=function(){return o(D(e),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props,r=n.query,o=n.datasource,a=n.onChange,e.next=4,o.getIPMetrics();case 4:(i=e.sent).length!==((null===(t=r.ipMetrics)||void 0===t?void 0:t.length)||0)&&a(Object.assign(Object.assign({},r),{ipMetrics:i}));case 6:case"end":return e.stop()}}),e,this)})))},e.getHostGroupMetrics=function(){return o(D(e),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props,r=n.query,o=n.datasource,a=n.onChange,e.next=4,o.getHostGroupMetrics();case 4:(i=e.sent).length!==((null===(t=r.hostGroupMetrics)||void 0===t?void 0:t.length)||0)&&a(Object.assign(Object.assign({},r),{hostGroupMetrics:i}));case 6:case"end":return e.stop()}}),e,this)})))},e.getWebAppMetrics=function(){return o(D(e),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props,r=n.query,o=n.datasource,a=n.onChange,e.next=4,o.getWebAppMetrics();case 4:(i=e.sent).length!==((null===(t=r.webAppMetrics)||void 0===t?void 0:t.length)||0)&&a(Object.assign(Object.assign({},r),{webAppMetrics:i}));case 6:case"end":return e.stop()}}),e,this)})))},e.getTopMetrics=function(){return o(D(e),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props,r=n.query,o=n.datasource,a=n.onChange,e.next=4,o.getTopMetrics(r.sourceGroup);case 4:(i=e.sent).length!==((null===(t=r.topMetrics)||void 0===t?void 0:t.length)||0)&&a(Object.assign(Object.assign({},r),{topMetrics:i}));case 6:case"end":return e.stop()}}),e,this)})))},e.getMetrics=function(){return o(D(e),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.getApplicationMetrics(),this.getIPMetrics(),this.getHostGroupMetrics(),this.getWebAppMetrics(),this.getTopMetrics();case 6:case"end":return e.stop()}}),e,this)})))},e.getOptions=function(t){t===a.application&&(e.getApplications(),e.getApplicationMetrics()),t===a.hostGroup&&(e.getHostGroups(),e.getHostGroupMetrics()),t===a.webApp&&(e.getWebApps(),e.getWebAppMetrics()),t===a.ip&&e.getIPMetrics(),e.getTopMetrics()},e.onSourceGroupChange=function(t){var n=e.props,r=n.onChange,o=n.query,a=n.onRunQuery;t.value!==o.sourceGroup&&(r(Object.assign(Object.assign({},o),{sourceGroup:t.value})),a())},e.onHostGroupChange=function(t){var n,r=e.props,o=r.onChange,a=r.query,i=r.onRunQuery;t.value!==(null===(n=a.currentHostGroup)||void 0===n?void 0:n.value)&&(o(Object.assign(Object.assign({},a),{currentHostGroup:t})),i())},e.onApplicationChange=function(t){var n,r=e.props,o=r.onChange,a=r.query,i=r.onRunQuery;t.value!==(null===(n=a.currentApplication)||void 0===n?void 0:n.value)&&(o(Object.assign(Object.assign({},a),{currentApplication:t})),i())},e.onWebAppChange=function(t){var n,r=e.props,o=r.onChange,a=r.query,i=r.onRunQuery;t.value!==(null===(n=a.currentWebApp)||void 0===n?void 0:n.value)&&(o(Object.assign(Object.assign({},a),{currentWebApp:t})),i())},e.onIPChange=function(t){var n=e.props,r=n.onChange,o=n.query,a=n.onRunQuery;r(Object.assign(Object.assign({},o),{currentIP:t.target.value})),a()},e.onApplicationMetricChange=function(t){var n,r=e.props,o=r.onChange,a=r.query,i=r.onRunQuery;t.value!==(null===(n=a.currentApplicationMetric)||void 0===n?void 0:n.value)&&(o(Object.assign(Object.assign({},a),{currentApplicationMetric:t})),i())},e.onHostGroupMetricChange=function(t){var n,r=e.props,o=r.onChange,a=r.query,i=r.onRunQuery;t.value!==(null===(n=a.currentHostGroupMetric)||void 0===n?void 0:n.value)&&(o(Object.assign(Object.assign({},a),{currentHostGroupMetric:t})),i())},e.onWebAppMetricChange=function(t){var n,r=e.props,o=r.onChange,a=r.query,i=r.onRunQuery;t.value!==(null===(n=a.currentWebAppMetric)||void 0===n?void 0:n.value)&&(o(Object.assign(Object.assign({},a),{currentWebAppMetric:t})),i())},e.onIPMetricChange=function(t){var n,r=e.props,o=r.onChange,a=r.query,i=r.onRunQuery;t.value!==(null===(n=a.currentIPMetric)||void 0===n?void 0:n.value)&&(o(Object.assign(Object.assign({},a),{currentIPMetric:t})),i())},e.onTopMetricChange=function(t){var n,r=e.props,o=r.onChange,a=r.query,i=r.onRunQuery;t.value!==(null===(n=a.currentTopMetric)||void 0===n?void 0:n.value)&&(o(Object.assign(Object.assign({},a),{currentTopMetric:t})),i())},e.onTopChange=function(t){var n=e.props,r=n.onChange,o=n.query,a=n.onRunQuery;r(Object.assign(Object.assign({},o),{top:t.currentTarget.checked})),a()},e.onTopGraphChange=function(t){var n=e.props,r=n.onChange,o=n.query,a=n.onRunQuery;r(Object.assign(Object.assign({},o),{topGraph:t.currentTarget.checked})),a()},e.onTopNChange=function(t){var n=e.props,r=n.onChange,o=n.query,a=n.onRunQuery;r(Object.assign(Object.assign({},o),{topN:Object(_.toInteger)(t.currentTarget.value)})),a()},e.onAliasChange=function(t){var n=e.props,r=n.onChange,o=n.query,a=n.onRunQuery;r(Object.assign(Object.assign({},o),{alias:t.target.value})),a()},e.onTimeshiftChange=function(t){var n=e.props,r=n.onChange,o=n.query,a=n.onRunQuery;r(Object.assign(Object.assign({},o),{timeshift:t.target.value})),a()},e.onGranularityChange=function(t){var n=e.props,r=n.query,o=n.onChange,a=n.onRunQuery;o(Object.assign(Object.assign({},r),{granularity:t})),a()},e}return t=s,(n=[{key:"render",value:function(){var e,t=this,n=Object(_.defaults)(this.props.query,l);return this.getOptions(n.sourceGroup),w.a.createElement("div",{style:{width:"100%"}},w.a.createElement(j.InlineFieldRow,null,w.a.createElement("div",{style:n.top?{display:"none"}:{display:"block"}},w.a.createElement(j.InlineField,{label:"Top"},w.a.createElement("div",{style:{marginTop:"8px"}},w.a.createElement(j.Switch,{value:n.top,checked:n.top,onChange:this.onTopChange})))),w.a.createElement(j.InlineField,{label:"Source Group"},w.a.createElement(j.Select,{width:"auto",menuShouldPortal:!0,options:u,value:n.sourceGroup,onChange:this.onSourceGroupChange})),w.a.createElement("div",{style:n.sourceGroup!==a.hostGroup||n.top?{display:"none"}:{display:"block"}},w.a.createElement(j.InlineField,{label:n.sourceGroup,onLoadStart:this.getHostGroups},w.a.createElement(j.Select,{width:"auto",menuShouldPortal:!0,value:n.currentHostGroup,options:n.hostGroups,onChange:this.onHostGroupChange}))),w.a.createElement("div",{style:n.sourceGroup!==a.application||n.top?{display:"none"}:{display:"block"}},w.a.createElement(j.InlineField,{label:n.sourceGroup,onLoadStart:this.getApplications},w.a.createElement(j.Select,{width:"auto",menuShouldPortal:!0,value:n.currentApplication,options:n.applications,onChange:this.onApplicationChange}))),w.a.createElement("div",{style:n.sourceGroup!==a.webApp||n.top?{display:"none"}:{display:"block"}},w.a.createElement(j.InlineField,{label:n.sourceGroup,onLoadStart:this.getWebApps},w.a.createElement(j.Select,{width:"auto",menuShouldPortal:!0,value:n.currentWebApp,options:n.webApps,onChange:this.onWebAppChange}))),w.a.createElement("div",{style:n.sourceGroup!==a.ip||n.top?{display:"none"}:{display:"block"}},w.a.createElement(j.InlineField,{label:n.sourceGroup},w.a.createElement(j.Input,{value:n.currentIP,onChange:this.onIPChange}))),w.a.createElement("div",{style:n.sourceGroup===a.application?{display:"block"}:{display:"none"}},w.a.createElement(j.InlineField,{label:"Metric",onLoadStart:function(){return t.getApplicationMetrics()}},w.a.createElement(j.Select,{width:"auto",menuShouldPortal:!0,options:n.applicationMetrics,value:n.currentApplicationMetric,onChange:this.onApplicationMetricChange}))),w.a.createElement("div",{style:n.sourceGroup===a.hostGroup?{display:"block"}:{display:"none"}},w.a.createElement(j.InlineField,{label:"Metric",onLoadStart:function(){return t.getHostGroupMetrics()}},w.a.createElement(j.Select,{width:"auto",menuShouldPortal:!0,options:n.hostGroupMetrics,value:n.currentHostGroupMetric,onChange:this.onHostGroupMetricChange}))),w.a.createElement("div",{style:n.sourceGroup===a.webApp?{display:"block"}:{display:"none"}},w.a.createElement(j.InlineField,{label:"Metric",onLoadStart:function(){return t.getWebAppMetrics()}},w.a.createElement(j.Select,{width:"auto",menuShouldPortal:!0,options:n.webAppMetrics,value:n.currentWebAppMetric,onChange:this.onWebAppMetricChange}))),w.a.createElement("div",{style:n.sourceGroup===a.ip?{display:"block"}:{display:"none"}},w.a.createElement(j.InlineField,{label:"Metric",onLoadStart:function(){return t.getIPMetrics()}},w.a.createElement(j.Select,{width:"auto",menuShouldPortal:!0,options:n.ipMetrics,value:n.currentIPMetric,onChange:this.onIPMetricChange})))),w.a.createElement(j.InlineFieldRow,null,w.a.createElement("div",{style:n.top?{display:"block"}:{display:"none"}},w.a.createElement(j.InlineField,{label:"Top"},w.a.createElement("div",{style:{marginTop:"8px"}},w.a.createElement(j.Switch,{value:n.top,checked:n.top,onChange:this.onTopChange})))),w.a.createElement("div",{style:n.top?{display:"block"}:{display:"none"}},w.a.createElement(j.InlineField,{label:"N"},w.a.createElement(j.Input,{width:16,value:n.topN||0,onChange:this.onTopNChange}))),w.a.createElement("div",{style:n.top?{display:"block"}:{display:"none"}},w.a.createElement(j.InlineField,{label:"Graph"},w.a.createElement("div",{style:{marginTop:"8px"}},w.a.createElement(j.Switch,{value:n.topGraph,checked:n.topGraph,onChange:this.onTopGraphChange})))),w.a.createElement("div",{style:n.top&&n.topGraph?{display:"block"}:{display:"none"}},w.a.createElement(j.InlineField,{label:"Top Metric",onLoadStart:function(){return t.getTopMetrics()}},w.a.createElement(j.Select,{width:"auto",menuShouldPortal:!0,options:n.topMetrics,value:n.currentTopMetric,onChange:this.onTopMetricChange})))),w.a.createElement(j.InlineFieldRow,null,w.a.createElement(j.InlineField,{label:"Granularity"},w.a.createElement(j.Select,{menuShouldPortal:!0,value:null===(e=n.granularity)||void 0===e?void 0:e.value,options:p,onChange:this.onGranularityChange})),w.a.createElement("div",{style:n.top?{display:"none"}:{display:"block"}},w.a.createElement(j.InlineField,{label:"Alias"},w.a.createElement(j.Input,{value:n.alias||"",onChange:this.onAliasChange})))))}}])&&T(t.prototype,n),r&&T(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(y.PureComponent);n.d(t,"plugin",(function(){return H}));var H=new r.DataSourcePlugin(m).setConfigEditor(R).setQueryEditor(q)}])}));
//# sourceMappingURL=module.js.map